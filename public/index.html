<button id="start">Start</button>
<input id="wave_type" type="range" min="0" max="4" value="0" />
<button class="note" data-note="60">C3</button>
<button class="note" data-note="72">C4</button>
<script type="module">
  const context = new AudioContext();
  let node = null;
  context.audioWorklet.addModule("js/a.js").then(() => {
    document.getElementById("start").onclick = (e) => {
      context.resume();
      node = new AudioWorkletNode(context, "a");
      node.connect(context.destination);
    };
    document.getElementById("wave_type").oninput = (e) => {
      const param = node.parameters.get("wave_type");
      const waveType = parseInt(e.target.value);
      param.value = waveType;
    };
    for (const el of document.getElementsByClassName("note")) {
      el.addEventListener("click", (e) => {
        const param = node.parameters.get("note");
        const note = parseInt(e.target.dataset.note);
        // param.value = note
        // param.setValueAtTime(note, context.currentTime + 0.3);
        // param.linearRampToValueAtTime(note, context.currentTime + 0.3);
        param.exponentialRampToValueAtTime(note, context.currentTime + 0.3);
      });
    }
  });
</script>
